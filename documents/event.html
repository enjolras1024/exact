<!DOCTYPE html>
<html>
<head lang="en">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>Exact</title>

  <link href="../stylesheets/codemirror.css" rel="stylesheet">
  <link href="../stylesheets/alice.css" rel="stylesheet">
  <link href="../stylesheets/defaults.css" rel="stylesheet">
  <!--<link href="../stylesheets/index.css" rel="stylesheet">-->


</head>
<body>
<header class="header">
  <nav class="nav-bar">
    <h3 class="brand"><a href="../" class="logo">Exact</a></h3>
    <a class="menu-btn"></a>
    <ul class="menu-bar">
      <li><a href="../examples/color-palette.html" class="menu-item"> Examples </a></li>
      <li><a href="../downloads/index.html" class="menu-item"> Downloads </a></li>
      <li><a href="../documents/index.html" class="menu-item  active"> Documents </a></li>
      <li><a href="../apis/index.html" class="menu-item"> APIs </a></li>
      <li><a href="https://github.com/enjolras1024/exact" class="menu-item"> GitHub </a></li>
    </ul>
  </nav>
</header>
<div class="main">
  <aside class="side-bar">
    <div class="card">
      <h4>Overview</h4>
      <ul class="list">
        <li><a href="./index.html#setup" class="link">Setup</a></li>
        <li><a href="./index.html#hello-world" class="link">Hello World</a></li>
        <li><a href="./index.html#composing" class="link">Composing</a></li>
      </ul>
    </div>
    <div class="card">
      <h4>Event</h4>
      <ul class="list">
        <li><a href="./event.html#on-off-once" class="link">On / Off / Once</a></li>
        <li><a href="./event.html#send-emit" class="link">Send / Emit</a></li>
        <li><a href="./event.html#event-type-and-event-name" class="link">Event Type & Event Name</a></li>
      </ul>
    </div>
    <div class="card">
      <h4>Models</h4>
      <ul class="list">
        <li><a href="./models.html#store-for-object" class="link">Store for Object</a></li>
        <li><a href="./models.html#collection-for-array" class="link">Collection for Array</a></li>
      </ul>
    </div>
    <div class="card">
      <h4>Component</h4>
      <ul class="list">
        <li><a href="./component.html#component-element-and-text" class="link">Component, Element and Text</a></li>
        <li><a href="./component.html#props-attrs-style-and-classes" class="link">Props, Attrs, Style and Classes</a></li>
        <li><a href="./component.html#defaults-and-descriptors" class="link">Defaults and Descriptors</a></li>
        <li><a href="./component.html#property-validtion" class="link">Property Validation</a></li>
        <li><a href="./component.html#property-interception" class="link">Property Interception</a></li>
        <li><a href="./component.html#property-denpendcy" class="link">Property Dependency</a></li>
        <li><a href="./component.html#children-and-contents" class="link">Children and Contents</a></li>
        <li><a href="./component.html#lifecycle-and-hooks" class="link">Lifecycle and Hooks</a></li>
      </ul>
    </div>
    <div class="card">
      <h4>Template</h4>
      <ul class="list">
        <li><a href="./template.html#event-handler" class="link">Event Handler</a></li>
        <li><a href="./template.html#data-binding" class="link">Data Binding</a></li>
        <li><a href="./template.html#optional-converters" class="link">Optional Converters</a></li>
        <li><a href="./template.html#javascript-expressions" class="link">JavaScript Expressions</a></li>
        <li><a href="./template.html#list-rendering" class="link">List Rendering</a></li>
        <li><a href="./template.html#condition-rendering" class="link">Condition Rendering</a></li>
        <li><a href="./template.html#child-components" class="link">Child Components</a></li>
        <li><a href="./template.html#contents-and-slots" class="link">Contents and Slots</a></li>
        <li><a href="./template.html#refrence-to-part" class="link">Reference to Part</a></li>
        <li><a href="./template.html#camlecase-vs-kebabcase" class="link">camelCase vs kebab-case</a></li>
      </ul>
    </div>
    <div class="card">
      <h4>Tips</h4>
      <ul class="list">
        <li><a href="./tips.html" class="link">Data Flow</a></li>
        <li><a href="./tips.html" class="link">Binding Instance Methods</a></li>
        <li><a href="./tips.html" class="link">Using RES to Manage Resources</a></li>
      </ul>
    </div>
  </aside>
  <a class="side-btn">&gt;</a>
  <article class="article">
    <a id="on-off-once"></a>
    <h2>Event</h2>
    <p>事件系统是Exact的基础，Watcher对象提供的实例方法，实现了监听、移除和派发任意类型事件的功能。Store、Element和Component等都混入了这些事件方法。</p>
    <h4 >On / Off / Once</h4>
    <p>用`on`方法来监听指定类型的事件，用`off`方法来移除相应类型的事件处理函数。用例如下：</p>
    <a id="send-emit"></a>
<!--<div class="code-box scroll">
      <pre class="code-behind">
  var onChange = function() {};

  watcher.on('click', function() {});
  watcher.on({
    click: function() {},
    change: onChange,
    invalid: function() {},
  } );

  watcher.off('change', onChange);  // 移除了change事件处理函数onChange
  watcher.off('click');             // 移除了所有click事件处理函数
  watcher.off();                    // 移除了所有类型事件处理函数</pre>
    </div>-->
    <div class="code-box scroll">
      <div class="CodeMirror cm-s-alice">
        <div class="CodeMirror-lines">
          <div style="position: relative; outline: none;">
            <div class="CodeMirror-code">
              <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span
                  class="cm-keyword">var</span> <span class="cm-def">onChange</span> <span class="cm-operator">=</span> <span
                  class="cm-keyword">function</span>() {};</span></pre>
              <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre>
              <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span
                  class="cm-variable">watcher</span>.<span class="cm-property">on</span>(<span
                  class="cm-string">'click'</span>, <span class="cm-keyword">function</span>() {});</span></pre>
              <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span
                  class="cm-variable">watcher</span>.<span class="cm-property">on</span>({</span></pre>
              <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span
                  class="cm-property">click</span>: <span class="cm-keyword">function</span>() {},</span></pre>
              <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span
                  class="cm-property">change</span>: <span class="cm-variable">onChange</span>,</span></pre>
              <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span
                  class="cm-property">invalid</span>: <span class="cm-keyword">function</span>() {},</span></pre>
              <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">} );</span></pre>
              <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre>
              <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span
                  class="cm-variable">watcher</span>.<span class="cm-property">off</span>(<span class="cm-string">'change'</span>, <span
                  class="cm-variable">onChange</span>);  <span
                  class="cm-comment">// 移除了change事件处理函数onChange</span></span></pre>
              <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span
                  class="cm-variable">watcher</span>.<span class="cm-property">off</span>(<span class="cm-string">'click'</span>);             <span
                  class="cm-comment">// 移除了所有click事件处理函数</span></span></pre>
              <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span
                  class="cm-variable">watcher</span>.<span class="cm-property">off</span>();                    <span
                  class="cm-comment">// 移除了所有类型事件处理函数</span></span></pre>
            </div>
          </div>
        </div>
      </div>
    </div>

    <p>特别地，用`once`监听事件，处理函数在第一次触发之后被自动移除。</p>
    <div class="code-box scroll">
      <div class="CodeMirror cm-s-alice">
        <div class="CodeMirror-lines">
          <div style="position: relative; outline: none;">
            <div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">watcher</span>.<span class="cm-property">once</span>(<span class="cm-string">'initialized'</span>, <span class="cm-keyword">function</span>(<span class="cm-def">event</span>) {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable-2">event</span>.<span class="cm-property">type</span>);</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">});</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">watcher</span>.<span class="cm-property">send</span>(<span class="cm-string">'initialized'</span>);<span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-comment">// 输出："initialized"</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">watcher</span>.<span class="cm-property">send</span>(<span class="cm-string">'initialized'</span>);<span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-comment">// 没有新的输出</span></span></pre></div>
          </div>
        </div>
      </div>
    </div>

    <p>对于DOM事件，默认监听的是冒泡阶段的事件。如果要监听捕获阶段的事件，请在事件类型前加一个`!`，像这样：</p>
    <div class="code-box scroll">
      <div class="CodeMirror cm-s-alice">
        <div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">watcher</span>.<span class="cm-property">on</span>(<span class="cm-string">'!click'</span>, <span class="cm-keyword">function</span>() {});</span></pre></div>
      </div>
    </div>

    <h4 >Send / Emit</h4>
    <p>用`send`或`emit`方法来派发事件，以及传递附带参数。
      对于`send`方法派发的事件，处理函数接受到的第一个参数为Event对象，而`emit`会忽略事件本身，只向处理函数传递附带参数。
      用例如下：</p>
 <!--   <div class="code-box scroll">
      <pre class="code-behind">
  function onClick(event, value) {
    console.log(event.type, value);
  }
  function onMessage(value) {
    console.log(value);
  }

  watcher.on('click' onClick);
  watcher.send('click');                      // 输出："click", undefined
  watcher.send('click', 'ok');                // 输出："click", "ok"
  watcher.emit('click', {type: 'not click'}); // 输出："not click", undefined

  watcher.on('message', onMessage);
  watcher.emit('message', 'ok');              // 输出："ok"</pre>
    </div>-->
    <div class="code-box scroll">
      <div class="CodeMirror cm-s-alice">
        <div class="CodeMirror-lines">
          <div style="position: relative; outline: none;">
            <div class="CodeMirror-code">
              <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span
                  class="cm-keyword">function</span> <span class="cm-def">onClick</span>(<span
                  class="cm-def">event</span>, <span class="cm-def">value</span>) {</span></pre>
              <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span
                  class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable-2">event</span>.<span
                  class="cm-property">type</span>, <span class="cm-variable-2">value</span>);</span></pre>
              <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">}</span></pre>
              <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span
                  class="cm-keyword">function</span> <span class="cm-def">onMessage</span>(<span
                  class="cm-def">value</span>) {</span></pre>
              <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span
                  class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable-2">value</span>);</span></pre>
              <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">}</span></pre>
              <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre>
              <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span
                  class="cm-variable">watcher</span>.<span class="cm-property">on</span>(<span
                  class="cm-string">'click'</span> <span class="cm-variable">onClick</span>);</span></pre>
              <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span
                  class="cm-variable">watcher</span>.<span class="cm-property">send</span>(<span class="cm-string">'click'</span>);                      <span
                  class="cm-comment">// 输出："click", undefined</span></span></pre>
              <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span
                  class="cm-variable">watcher</span>.<span class="cm-property">send</span>(<span class="cm-string">'click'</span>, <span
                  class="cm-string">'ok'</span>);                <span
                  class="cm-comment">// 输出："click", "ok"</span></span></pre>
              <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span
                  class="cm-variable">watcher</span>.<span class="cm-property">emit</span>(<span class="cm-string">'click'</span>, {<span
                  class="cm-property">type</span>: <span class="cm-string">'not click'</span>}); <span
                  class="cm-comment">// 输出："not click", undefined</span></span></pre>
              <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre>
              <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span
                  class="cm-variable">watcher</span>.<span class="cm-property">on</span>(<span class="cm-string">'message'</span>, <span
                  class="cm-variable">onMessage</span>);</span></pre>
              <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span
                  class="cm-variable">watcher</span>.<span class="cm-property">emit</span>(<span class="cm-string">'message'</span>, <span
                  class="cm-string">'ok'</span>);              <span class="cm-comment">// 输出："ok"</span></span></pre>
            </div>
          </div>
        </div>
      </div>
    </div>
    <a id="event-type-and-event-name"></a>
    <p>在Exact内部，默认使用send方法派发自定义事件和转发DOM事件，相应处理函数接受到的第一个参数始终是Event对象。</p>

    <h4>Event Type & Event Name</h4>
    <p>通常在监听键盘事件时，我们会关心用户按下的键名。同样，当某个属性的值发生改变或验证失败时，我们会关心这个属性的名字。
      为此，Exact的事件系统特别照顾到了这种情况，允许同一类型的事件有不同的事件名，这使得事件的监听和移除方法更为灵活。</p>
    <div class="code-box scroll">
      <!--<pre class="code-behind js-mode">
  function onEnter(event) {
    console.log('key `' + event.name + '` is pressed');
  }
  function onChanged(event) {
    console.log('prop `' + event.name + '` is changed');
  }
  function onTitleChanged(event) {
    console.log('prop `title` is changed, really');
  }

  element.on('keypress.enter', onEnter); // 按下Enter键时，才会输出：key `enter` is pressed
  element.on('changed', onChanged);
  element.on('changed.title', onTitleChanged);

  element.send('changed.title');         // 输出：prop `title` is changed
                                         // 输出：prop `title` is changed, really
  element.send('changed.other');         // 输出：prop `other` is changed

  element.off('keypress.enter');         // 只移除了name为`enter`的keypress事件的处理函数
  element.off('changed');                // 移除了所有changed事件的处理函数，无论name是什么</pre>-->
      <div class="CodeMirror cm-s-alice">
        <div class="CodeMirror-lines">
          <div style="position: relative; outline: none;">
            <div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">function</span> <span class="cm-def">onEnter</span>(<span class="cm-def">event</span>) {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string">'key `'</span> <span class="cm-operator">+</span> <span class="cm-variable-2">event</span>.<span class="cm-property">name</span> <span class="cm-operator">+</span> <span class="cm-string">'` is pressed'</span>);</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">function</span> <span class="cm-def">onChanged</span>(<span class="cm-def">event</span>) {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string">'prop `'</span> <span class="cm-operator">+</span> <span class="cm-variable-2">event</span>.<span class="cm-property">name</span> <span class="cm-operator">+</span> <span class="cm-string">'` is changed'</span>);</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">function</span> <span class="cm-def">onLabelChanged</span>(<span class="cm-def">event</span>) {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string">'prop `label` is changed, really'</span>);</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">component</span>.<span class="cm-property">on</span>(<span class="cm-string">'keypress.enter'</span>, <span class="cm-variable">onEnter</span>);<span class="cm-comment">// 按下Enter键时，才会输出：key `enter` is pressed</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">component</span>.<span class="cm-property">on</span>(<span class="cm-string">'changed'</span>, <span class="cm-variable">onChanged</span>);</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">component</span>.<span class="cm-property">on</span>(<span class="cm-string">'changed.label'</span>, <span class="cm-variable">onLabelChanged</span>);</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">component</span>.<span class="cm-property">send</span>(<span class="cm-string">'changed.label'</span>);  <span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-comment">// 输出：prop `label` is changed</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">                                 <span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-comment">// 输出：prop `label` is changed, really</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">component</span>.<span class="cm-property">send</span>(<span class="cm-string">'changed.other'</span>);        <span class="cm-comment">// 输出：prop `other` is changed</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">component</span>.<span class="cm-property">off</span>(<span class="cm-string">'keypress.enter'</span>);        <span class="cm-comment">// 只移除了name为`enter`的keypress事件的处理函数</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">component</span>.<span class="cm-property">off</span>(<span class="cm-string">'changed'</span>);               <span class="cm-comment">// 移除了所有changed事件的处理函数，无论name是什么</span></span></pre></div>
          </div>
        </div>
      </div>
    </div>
  </article>
</div>
<!--<footer class="footer">
  <p>Released under the MIT license<br>
    © 2015 Chen Junyong. All rights reserved.</p>
</footer>-->

<!--<script src="../javascripts/codemirror.js"></script>-->
<!--<script src="../javascripts/javascript-mode.js"></script>-->
<!--<script src="../javascripts/code-format.js"></script>-->
<script src="../javascripts/site.js"></script>
</body>
</html>