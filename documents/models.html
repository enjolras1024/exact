<!DOCTYPE html>
<html>
<head lang="en">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>Exact</title>

  <link href="../stylesheets/codemirror.css" rel="stylesheet">
  <link href="../stylesheets/alice.css" rel="stylesheet">
  <link href="../stylesheets/defaults.css" rel="stylesheet">
  <!--<link href="../stylesheets/index.css" rel="stylesheet">-->


</head>
<body>
<header class="header">
  <nav class="nav-bar">
    <h3 class="brand"><a href="../" class="logo">Exact</a></h3>
    <a class="menu-btn"></a>
    <ul class="menu-bar">
      <li><a href="../examples/todomvc.html" class="menu-item"> Examples </a></li>
      <li><a href="#" class="menu-item  active"> Documents </a></li>
      <li><a href="#" class="menu-item"> Downloads </a></li>
      <li><a href="#" class="menu-item"> Blogs </a></li>
      <li><a href="#" class="menu-item"> GitHub </a></li>
    </ul>
  </nav>
</header>
<div class="main">
  <aside class="side-bar">
    <div class="card">
      <h4>Overview</h4>
      <ul class="list">
        <li><a href="./" class="link">Introduction</a></li>
        <li><a href="./installation.html" class="link">Installation</a></li>
      </ul>
    </div>
    <div class="card">
      <h4>Events</h4>
      <ul class="list">
        <li><a href="./events.html#on-off" class="link">On / Off</a></li>
        <li><a href="./events.html#send-emit" class="link">Send / Emit</a></li>
        <li><a href="./events.html#keys-of-event" class="link">Keys of Event</a></li>
      </ul>
    </div>
    <div class="card">
      <h4>Properties</h4>
      <ul class="list">
        <li><a href="./properties.html#setting-property" class="link">Setting Property</a></li>
        <li><a href="./properties.html#declaring-descriptors" class="link">Declaring Descriptors</a></li>
        <li><a href="./properties.html#adding-validation" class="link">Adding Validation</a></li>
        <li><a href="./properties.html#dirty-marking" class="link">Dirty Marking</a></li>
        <li><a href="./properties.html#property-changed-event" class="link">Property-Changed Event</a></li>
      </ul>
    </div>
    <div class="card">
      <h4>Models</h4>
      <ul class="list">
        <li><a href="./models.html#store-for-object" class="link">Cache / Store for Object</a></li>
        <li><a href="./models.html#collection-for-array" class="link">Collection for Array</a></li>
      </ul>
    </div>
    <div class="card">
      <h4>Components</h4>
      <ul class="list">
        <li><a href="./shadow-skin-template.html" class="link">Shadow & Skin & Template</a></li>
        <li><a href="./components.html#using-template-strings-as-texts" class="link">Using Template Strings as Texts</a></li>
        <li><a href="./components.html#setting-attributes-of-elements" class="link">Setting Attributes of Elements</a></li>
        <li><a href="./components.html#syntax-of-events-style-class" class="link">Syntax of Events, Style, Class</a></li>
        <li><a href="./children-and-contents" class="link">Children and Contents</a></li>
        <li><a href="./lifecycle-and-hooks.html" class="link">Lifecycle and Hooks</a></li>
        <li><a href="./lists-and-itemadapters.html" class="link">Lists and ItemAdapters</a></li>
        <li><a href="./form-inputs.html" class="link">Form Inputs</a></li>
      </ul>
    </div>
    <div class="card">
      <h4>Bindings</h4>
      <ul class="list">
        <li><a href="./bindings.html#syntax" class="link">Syntax</a></li>
        <li><a href="./bindings.html#key-terms" class="link">Key Terms</a></li>
        <li><a href="./bindings.html#optional-filters" class="link">Optional Filters</a></li>
        <li><a href="./bindings.html#javaScript-expressions" class="link">JavaScript Expressions</a></li>
      </ul>
    </div>
    <div class="card">
      <h4>Tips</h4>
      <ul class="list">
        <li><a href="./data-flow.html" class="link">Data Flow</a></li>
        <li><a href="./using-mixins.html" class="link">Using Mixins</a></li>
        <li><a href="./merging-descriptors.html" class="link">Merging Descriptors</a></li>
        <li><a href="./binding-instance-methods.html" class="link">Binding Instance Methods</a></li>
        <li><a href="./using-res-to-manage-resources.html" class="link">Using RES to Manage resources</a></li>
        <li><a href="./using-objectutil-to-update-and-clone.html" class="link">Using ObjectUtil to Update or Clone</a></li>
      </ul>
    </div>
  </aside>
  <a class="side-btn">&gt;</a>
  <article class="article">
    <a id="on-off"></a>
    <h2>Models</h2>
    <p>Exact提供的Cache和Collection都具有钩子函数`onChange`。当Cache或Collection发生变动时，都会触发钩子函数`onChange`。
      例如，一个Element对象的style属性即为Cache对象，children属性即为Collection对象，它们的钩子函数`onChange`都勾在了Element对象`invalidate`方法上。
      所以每当一个Element对象的style或children发生变化时，这个Element对象就启动失效机制，等待渲染。
    </p>
    <p>另外，Exact提供了Store类，具有不同与Cache的功能组合，满足开发中的一些特殊需求。当然，如果没有特殊要求，你也可以直接使用普通的Object来提供数据。</p>

    <h4 >Cache / Store for Object</h4>
    <p>Cache只有一个必需的`set`方法和一个可选的钩子函数`onChange`，具有脏标记的功能。而Store没有脏标记的功能，但具有更新通知和属性验证的功能。用例如下：</p>
    <a id="send-emit"></a>
    <div class="code-box">
      <pre class="code-behind js-mode">
  var cache = new Exact.Cache({x: 1});
  cache.onChange = function() {
    console.log(cache.hasDirty('x'), cache.x);
  }
  cache.set('x', 2); // 输出：true 2

  var store = new Exact.Store({y: 1});
  store.on('changed', function(event) {
    console.log(event.keyName, store.y);
  });
  store.set('y', 2); // 输出："y" 2
      </pre>
    </div>
    <p>因为Store对象具有更新通知的功能，所以可将一个Store对象的属性绑定到Shadow层。</p>
    <h4 >Collection for Array</h4>
    <p>Collection继承自Array，重写了`push`等改变本身结构的方法。在这些方法里，都添加了钩子函数`onChange`。
      所以当一个Collection对象发生增删或替换时，就会触发钩子函数`onChange`。
      用例如下：</p>
    <div class="code-box">
      <pre class="code-behind js-mode">
  var collection = new Exact.Collection(1,2,3);
  console.log(collection)       // 输出：[1,2,3]

  collection = Exact.Collection.from([0,1,2]);
  console.log(collection)       // 输出：[0,1,2]

  collection.onChange = function() {
    console.log(collection);
  }

  collection.push(3, 4);        // 输出：[0,1,2,3,4]
  collection.unshift(-1);       // 输出：[-1,0,1,2,3,4]
  collection.pop();             // 输出：[-1,0,1,2,3]
  collection.shift();           // 输出：[0,1,2,3]
  collection.splice(2, 0, 1.5); // 输出：[0,1,1.5,2,3]
  </pre>
    </div>
  <p>Collection没有重写`slice`等不改变本身结构的方法，这些方法依然返回新的数组而非新的Collection对象。
  针对对象元素，Collection额外提供了`insert`、`remove`和`replace`三个方法。这三个方法只接受对象元素作参数，否则抛出错误。用法如下：</p>
    <div class="code-box">
      <pre class="code-behind js-mode">
  var collection = new Exact.Collection();

  // 末尾插入
  collection.insert({x: 1});
  collection.insert({x: 2});                // [{x: 1}, {x: 2}]

  // 在某个已有元素之前插入
  collection.insert({x: 0), collection[0]); // [{x: 0}, {x: 1}, {x: 2}]

  // 移除已有元素
  collection.remove(collection[1]);         // [{x: 0}, {x: 2}]

  // 替换已有元素
  collection.replace(collection[1], {x: 1});// [{x: 0}, {x: 1}]
  </pre>
    </div>
  </article>
</div>
<!--<footer class="footer">
  <p>Released under the MIT license<br>
    © 2015 Chen Junyong. All rights reserved.</p>
</footer>-->

<script src="../javascripts/codemirror.js"></script>
<script src="../javascripts/javascript-mode.js"></script>
<script src="../javascripts/code-format.js"></script>
<script src="../javascripts/menu.js"></script>
</body>
</html>