<!DOCTYPE html>
<html>
<head lang="en">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>Exact</title>

  <link href="../stylesheets/codemirror.css" rel="stylesheet">
  <link href="../stylesheets/alice.css" rel="stylesheet">
  <link href="../stylesheets/defaults.css" rel="stylesheet">
  <!--<link href="../stylesheets/index.css" rel="stylesheet">-->


</head>
<body>
<header class="header">
  <nav class="nav-bar">
    <h3 class="brand"><a href="../" class="logo">Exact</a></h3>
    <a class="menu-btn"></a>
    <ul class="menu-bar">
      <li><a href="../examples/color-palette.html" class="menu-item"> Examples </a></li>
      <li><a href="../downloads/index.html" class="menu-item"> Downloads </a></li>
      <li><a href="../documents/index.html" class="menu-item  active"> Documents </a></li>
      <li><a href="../apis/index.html" class="menu-item"> APIs </a></li>
      <li><a href="https://github.com/enjolras1024/exact" class="menu-item"> GitHub </a></li>
    </ul>
  </nav>
</header>
<div class="main">
  <aside class="side-bar">
    <div class="card">
      <h4>Overview</h4>
      <ul class="list">
        <li><a href="./index.html#setup" class="link">Setup</a></li>
        <li><a href="./index.html#hello-world" class="link">Hello World</a></li>
      </ul>
    </div>
    <div class="card">
      <h4>Events</h4>
      <ul class="list">
        <li><a href="./event.html#on-off-once" class="link">On / Off / Once</a></li>
        <li><a href="./event.html#send-emit" class="link">Send / Emit</a></li>
        <li><a href="./event.html#key-name-of-event" class="link">Key Name of Event</a></li>
      </ul>
    </div>
    <div class="card">
      <h4>Models</h4>
      <ul class="list">
        <li><a href="./models.html#store-for-object" class="link">Store for Object</a></li>
        <li><a href="./models.html#collection-for-array" class="link">Collection for Array</a></li>
      </ul>
    </div>
    <div class="card">
      <h4>Components</h4>
      <ul class="list">
        <li><a href="./component.html#component-element-and-text" class="link">Component, Element and Text</a></li>
        <li><a href="./component.html#props-attrs-style-and-classes" class="link">Props, Attrs, Style and Classes</a></li>
        <li><a href="./component.html#defaults-and-descriptors" class="link">Defaults and Descriptors</a></li>
        <li><a href="./component.html#property-validtion" class="link">Property Validation</a></li>
        <li><a href="./component.html#property-interception" class="link">Property Interception</a></li>
        <li><a href="./component.html#property-denpendcy" class="link">Property Dependency</a></li>
        <li><a href="./component.html#children-and-contents" class="link">Children and Contents</a></li>
        <li><a href="./component.html#lifecycle-and-hooks" class="link">Lifecycle and Hooks</a></li>
      </ul>
    </div>
    <div class="card">
      <h4>Template Syntax</h4>
      <ul class="list">
        <li><a href="./template.html#event-handler" class="link">Event Handler</a></li>
        <li><a href="./template.html#data-binding" class="link">Data Binding</a></li>
        <li><a href="./template.html#optional-converters" class="link">Optional Converters</a></li>
        <li><a href="./template.html#javascript-expressions" class="link">JavaScript Expressions</a></li>
        <li><a href="./template.html#list-rendering" class="link">List Rendering</a></li>
        <li><a href="./template.html#condition-rendering" class="link">Condition Rendering</a></li>
        <li><a href="./template.html#child-components" class="link">Child Components</a></li>
        <li><a href="./template.html#contents-and-slots" class="link">Contents and Slots</a></li>
        <li><a href="./template.html#refrence-to-part" class="link">Reference to Part</a></li>
        <li><a href="./template.html#camlecase-vs-kebabcase" class="link">camelCase vs kebab-case</a></li>
      </ul>
    </div>
    <div class="card">
      <h4>Tips</h4>
      <ul class="list">
        <li><a href="./tips.html" class="link">Data Flow</a></li>
        <li><a href="./tips.html" class="link">Binding Instance Methods</a></li>
        <li><a href="./tips.html" class="link">Using RES to Manage Resources</a></li>
      </ul>
    </div>
  </aside>
  <a class="side-btn">&gt;</a>
  <article class="article">
    <a id="component-element-and-text"></a>
    <h2>Components</h2>
    <p>组件系统是Exact的重中之重，其他模块和类几乎都是在为组件的实现做铺垫。组件是对一般标签元素的扩展，支持模板、属性更改通知、属性验证等高级功能。</p>
    <h4>Component, Element and Text</h4>
    <p>组件、元素和文本共同组成了Shadow层。文本是最简单的，元素则可以设置样式、插入或移除子节点等。
      一般来说，使用组件和模板后，你不需要手动创建文本、元素或子组件。下面的代码展示了相关的api，移步<a class="link-live">这里</a>可以看到结果。</p>
    <div class="code-box scroll">
      <div class="CodeMirror cm-s-alice">
        <div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">text</span> <span class="cm-operator">=</span> <span class="cm-variable">Exact</span>.<span class="cm-property">Text</span>.<span class="cm-property">create</span>(<span class="cm-string">''</span>);</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">text</span>.<span class="cm-property">set</span>(<span class="cm-string">'data'</span>, <span class="cm-string">"It's a rect"</span>);</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">span</span> <span class="cm-operator">=</span> <span class="cm-variable">Exact</span>.<span class="cm-property">Element</span>.<span class="cm-property">create</span>(<span class="cm-string">'span'</span>);</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">span</span>.<span class="cm-property">set</span>(<span class="cm-string">'title'</span>, <span class="cm-string">'...'</span>);</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">span</span>.<span class="cm-property">style</span>.<span class="cm-property">set</span>(<span class="cm-string">'color'</span>, <span class="cm-string">'white'</span>);</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">span</span>.<span class="cm-property">classes</span>.<span class="cm-property">set</span>(<span class="cm-string">'dark-bg'</span>, <span class="cm-atom">true</span>); <span class="cm-comment">// 第二个参数表示是否包含该类名</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">span</span>.<span class="cm-property">children</span>.<span class="cm-property">insert</span>(<span class="cm-variable">text</span>);</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">rect</span> <span class="cm-operator">=</span> <span class="cm-variable">Exact</span>.<span class="cm-property">Element</span>.<span class="cm-property">create</span>(<span class="cm-string">'rect'</span>, <span class="cm-string">'svg'</span>); <span class="cm-comment">// 第二个参数指定命名空间</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">rect</span>.<span class="cm-property">save</span>({<span class="cm-property">width</span>: <span class="cm-number">100</span>, <span class="cm-property">height</span>: <span class="cm-number">100</span>});</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">rect</span>.<span class="cm-property">style</span>.<span class="cm-property">save</span>({<span class="cm-property">fill</span>: <span class="cm-string">'rgb(0, 120, 240)'</span>});</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">rect</span>.<span class="cm-property">attrs</span>.<span class="cm-property">save</span>({<span class="cm-property">transform</span>: <span class="cm-string">'translate(10, 10)'</span>});</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">svg</span> <span class="cm-operator">=</span> <span class="cm-variable">Exact</span>.<span class="cm-property">Element</span>.<span class="cm-property">create</span>(<span class="cm-string">'svg'</span>, <span class="cm-string">'svg'</span>);</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">svg</span>.<span class="cm-property">children</span>.<span class="cm-property">insert</span>(<span class="cm-variable">rect</span>);</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">Panel</span> <span class="cm-operator">=</span> <span class="cm-variable">Exact</span>.<span class="cm-property">defineClass</span>({</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-property">extend</span>: <span class="cm-variable">Exact</span>.<span class="cm-property">Component</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-property">statics</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-property">template</span>:  <span class="cm-string">'&lt;div class="panel" x-style="border?: solid 2px @{ $.color };"&gt;'</span> <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">                  <span class="cm-string">'&lt;h3 class="head" x-style="background-color@: $.color;"&gt;@{ $.title }&lt;/h3&gt;'</span> <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">                  <span class="cm-string">'&lt;div class="body"&gt;&lt;slot&gt;&lt;/slot&gt;&lt;/div&gt;'</span> <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">                <span class="cm-string">'&lt;/div&gt;'</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-property">descriptors</span>: { <span class="cm-property">title</span>: <span class="cm-atom">null</span>, <span class="cm-property">color</span>: <span class="cm-atom">null</span> }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">});</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">panel</span> <span class="cm-operator">=</span> <span class="cm-variable">Exact</span>.<span class="cm-property">Component</span>.<span class="cm-property">create</span>(<span class="cm-variable">Panel</span>);</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">panel</span>.<span class="cm-property">save</span>({<span class="cm-property">title</span>: <span class="cm-string">'SVG'</span>, <span class="cm-property">color</span>: <span class="cm-string">'#eee'</span>}); <span class="cm-comment">// 设置DOM属性或自定义属性</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">panel</span>.<span class="cm-property">set</span>(<span class="cm-string">'contents'</span>, [<span class="cm-variable">svg</span>, <span class="cm-variable">span</span>]); <span class="cm-comment">// 模板中slot处会被替换为svg和span</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">// 同样可以手动设置style、classes，一般不会手动更新组件的attrs和children</span></span></pre></div>
      </div>
    </div>
    <a id="props-attrs-style-and-classes"></a>
    <p>需要特别说明的是，Text和Element作为final class都是不能被继承的，而Component具有很好的可扩展性。</p>

    <h4>Props, Attrs, Style and Classes</h4>
    <a id="defaults-and-descriptors"></a>
    <p>无论是组件、元素还是文本，都可使用set方法更新它的DOM属性值（save只是多次调用set）。
      某个DOM属性的值发生更改时，这个DOM属性就会被标记为脏，并触发失效机制，等待渲染。异步渲染后，脏标记被自动清除。</p>
    <p>对于组件和元素，它们的成员对象style、attrs和classes，都有脏标记的功能，并与失效机制挂钩。因为我们可以在模板使用数据绑定，所以一般不需要手动更新style、attrs和classes的属性值。</p>

    <h4>Defaults and Descriptors</h4>
    <p>对于组件，可以有自定义属性，可自定义属性的默认值，还可为自定义属性添加一些描述。如果在类的静态函数`defaults`或静态属性`descriptors`中声明了某个属性，在创建这一组件的首个实例时，就会为这个自定义属性创建一对getter和setter。
    对于这样自定义的属性，当它的值发生改变时，会派发属性更改通知，触发失效机制。</p>
    <div class="code-box scroll">
      <div class="CodeMirror cm-s-alice">
        <div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">Demo</span> <span class="cm-operator">=</span> <span class="cm-variable">Exact</span>.<span class="cm-property">defineClass</span>({</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-property">extend</span>: <span class="cm-variable">Exact</span>.<span class="cm-property">Component</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-property">statics</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-property">descriptors</span>: {<span class="cm-property">active</span>: <span class="cm-atom">null</span>, <span class="cm-property">label</span>: <span class="cm-atom">null</span>},<span class="cm-comment">// or descriptors: ['active', 'label']</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-property">defaults</span>: <span class="cm-keyword">function</span>() {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-keyword">return</span> {<span class="cm-property">active</span>: <span class="cm-atom">true</span>, <span class="cm-property">amount</span>: <span class="cm-number">1000</span>};</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">});</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">demo</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">Demo</span>();</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">demo</span>.<span class="cm-property">label</span> <span class="cm-operator">=</span> <span class="cm-string">'abcd'</span>;    <span class="cm-comment">// 等效于demo.set('label', 'abcd')，派发事件`changed.label`;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">demo</span>.<span class="cm-property">active</span> <span class="cm-operator">=</span> <span class="cm-atom">false</span>;    <span class="cm-comment">// 等效于demo.set('active', false)，派发事件`changed.active`;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">demo</span>.<span class="cm-property">amount</span> <span class="cm-operator">=</span> <span class="cm-number">20000</span>;    <span class="cm-comment">// 等效于demo.set('amount', 20000)，派发事件`changed.amount`;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">demo</span>.<span class="cm-property">undeclared</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>;    <span class="cm-comment">// 不同于demo.set('undeclared', 1);</span></span></pre></div>
      </div>
    </div>
    <p>注意，`defaults`或`descriptors`中自定义的属性，默认是没有脏标记功能的，不会被渲染到真实DOM层。如果希望原生DOM属性更改时派发通知，或者希望自定以属性能渲染到真实DOM上，可以在`descriptors`中进行特别声明。
    下面创建的组件TextBox，它的属性`value`是支持双向绑定的。</p>
    <a id="property-validtion"></a>
    <div class="code-box scroll">
      <div class="CodeMirror cm-s-alice">
        <div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">TextBox</span> <span class="cm-operator">=</span> <span class="cm-variable">Exact</span>.<span class="cm-property">defineClass</span>({</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-property">extend</span>: <span class="cm-variable">Exact</span>.<span class="cm-property">Component</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-property">statics</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-property">descriptors</span>: { </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-property">value</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-property">native</span>: <span class="cm-atom">true</span> <span class="cm-comment">// 指示该属性为原生DOM属性，方可渲染到真实DOM</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    },</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-property">template</span>: <span class="cm-string">'&lt;input type="text" change+="$.onChange(event)"&gt;'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  },</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-property">onChange</span>: <span class="cm-keyword">function</span>(<span class="cm-def">event</span>) {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">this</span>.<span class="cm-property">value</span> <span class="cm-operator">=</span> <span class="cm-variable-2">event</span>.<span class="cm-property">target</span>.<span class="cm-property">value</span>;</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">});</span></pre></div>
      </div>
    </div>

    <h4>Property Validation</h4>
    <p>一些场景下，在更新属性值时，我们可能需要验证一下值的类型或其他因素。 为此，我们可以在子组件类的静态属性`descriptors`中这样进行定义：</p>
    <div class="code-box scroll">
      <div class="CodeMirror cm-s-alice">
        <div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">descriptors</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-comment">// 无需验证</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">x</span>: {},</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">y</span>: <span class="cm-atom">null</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-comment">// 对于boolean、number、string类型</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">label</span>: <span class="cm-string">'string'</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">amount</span>: <span class="cm-string">'number'</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">active</span>: <span class="cm-string">'boolean'</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-comment">// 对于Object类型</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">tool</span>: <span class="cm-variable">Knife</span>, <span class="cm-comment">// Knife是类的构造函数</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">items</span>: <span class="cm-variable">Array</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-comment">// 以上是简单的类型验证，亦可允许多类型，模式匹配或自定义一个验证函数</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">date</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">type</span>: [<span class="cm-string">'number'</span>, <span class="cm-string">'string'</span>, <span class="cm-variable">Date</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  },</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">name</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">validator</span>: <span class="cm-string-2">/^[a-zA-Z0-9]{1,32}$/</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  },</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">score</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">type</span>: <span class="cm-string">'number'</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">validator</span>: <span class="cm-keyword">function</span>(<span class="cm-def">value</span>) {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-keyword">if</span> (<span class="cm-variable-2">value</span> <span class="cm-operator">&lt;</span> <span class="cm-number">0</span> <span class="cm-operator">||</span> <span class="cm-variable-2">value</span> <span class="cm-operator">&gt;</span> <span class="cm-number">100</span>) {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-keyword">return</span> <span class="cm-keyword">new</span> <span class="cm-variable">Error</span>(<span class="cm-string">'out of the range 0~100'</span>);</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">}</span></pre></div>
      </div>
    </div>
    <a id="property-coercion"></a>
    <p>于是，`date`属性可接收的值包括123456、"2016/11/18"或者Date对象；`name`属性接收的值与模式不匹配时，不会将该值赋给`name`；`score`的数字范围需在区间[0,100]上。
      验证后会派发带有keyName的 `validated` 的事件，并附带参数error（为<span class="expr">null</span> 时，表示验证通过）。</p>

    <h4>Property Coercion</h4>
    <p>属性值经过验证之后，我们可能需要对属性值做一些强制变换。比如，得分范围在0至100之间，超出之后就应修整。</p>
    <a id="property-interception"></a>
    <div class="code-box scroll">
      <div class="CodeMirror cm-s-alice">
        <div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">Demo</span> <span class="cm-operator">=</span> <span class="cm-variable">Exact</span>.<span class="cm-property">defineClass</span>({</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-property">extend</span>: <span class="cm-variable">Exact</span>.<span class="cm-property">Component</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-property">statics</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-property">descriptors</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-property">score</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-property">type</span>: <span class="cm-string">'number'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">coerce</span>: <span class="cm-keyword">function</span>(<span class="cm-variable">value</span>) { <span class="cm-comment">// 验证过后，强制裁剪</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">          <span class="cm-keyword">return</span> <span class="cm-variable">value</span> <span class="cm-operator">&lt;</span> <span class="cm-number">0</span> <span class="cm-operator">?</span> <span class="cm-number">0</span> : (<span class="cm-variable">value</span> <span class="cm-operator">&gt;</span> <span class="cm-number">100</span> <span class="cm-operator">?</span> <span class="cm-number">100</span> : <span class="cm-variable">value</span>);</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">});</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">demo</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">Demo</span>();</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">demo</span>.<span class="cm-property">score</span> <span class="cm-operator">=</span> <span class="cm-number">120</span>;        </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">demo</span>.<span class="cm-property">score</span>);    <span class="cm-comment">// 输出：100</span></span></pre></div>
      </div>
    </div>

    <h4>Property Interception</h4>
    <p>Exact允许你在`descriptors`中自定义`get`或`set`方法，来拦截原有的取值、赋值的操作。 你可以在自定义的`get`方法中覆盖默认的返回值，可以在自定义的`set`方法中追加一些行为，等等。</p>
    <a id="property-denpendcy"></a>
    <div class="code-box scroll">
      <div class="CodeMirror cm-s-alice">
        <div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">{</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">template</span>: <span class="cm-string">'&lt;h2&gt;@{ $.fullName }&lt;/h2&gt;'</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-variable">descriptors</span>: [{</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-property">fullName</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-property">depends</span>: [<span class="cm-string">'firstName'</span>, <span class="cm-string">'lastName'</span>],</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-property">get</span>: <span class="cm-keyword">function</span>() {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-keyword">return</span> <span class="cm-keyword">this</span>.<span class="cm-property">firstName</span> <span class="cm-operator">+</span> <span class="cm-string">' '</span> <span class="cm-operator">+</span> <span class="cm-keyword">this</span>.<span class="cm-property">lastName</span>;</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-comment">//,set: function(value) {</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-comment">//   var names = value.split(' ');</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-comment">//   this.save({firtName: names[0], lastName: names[1]});</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-comment">//}</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  }]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">}</span></pre></div>
      </div>
    </div>

    <h4>Property Dependency</h4>
    <a id="children-and-contents"></a>
    <p>组件模板中支持的绑定表达式是丰富的，但是Exact建议不要书写冗长而难以阅读的绑定表达式。
      如果一个绑定表达式含有多个绑定路径或者逻辑过于复杂，你可以考虑在<span class="expr">descriptors</span>中定义一个依赖于其他绑定路径的属性。
      就比如上面代码展示的，`depends`指明属性`fullName`依赖于`fistName`和`lastName`。只要`firstName`或`lastName`的值发生改变，就会重新将`fullName`渲染到页面。</p>

    <h4>Children and Contents</h4>
    <p>同样，元素和组件都有children，它是<a class="link-live">Collection</a>对象，继承自Array，添加了方法insert、remove和replace，对应DOM操作中的insertBefore、removeChild和replaceChild。
    通过监听changed事件，children内部的变化也与失效机制实现了挂钩。</p>
    <p>组件在内部管理自己的children，在外部接受contents。在模板中，你可以使用slot标签来自动收集匹配的contents，就像<a class="link-live">第一节</a>那样。
      具体用法参见<a class="link-live">Contents and Slots</a>。或者不使用slot，你也可以选择在何处手动插入来自外部的contents。</p>
    <a id="lifecycle-and-hooks"></a>
    <div class="code-box scroll">
      <div class="CodeMirror cm-s-alice">
        <div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">// ...</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">Panel</span> <span class="cm-operator">=</span> <span class="cm-variable">Exact</span>.<span class="cm-property">defineClass</span>({</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-property">extend</span>: <span class="cm-variable">Exact</span>.<span class="cm-property">Component</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-property">statics</span>: {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-property">template</span>:  <span class="cm-string">'&lt;div class="panel" x-style="border?: solid 2px @{ $.color };"&gt;'</span> <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">                  <span class="cm-string">'&lt;h3 class="head" x-style="background-color@: $.color;"&gt;@{ $.title }&lt;/h3&gt;'</span> <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">                  <span class="cm-string">'&lt;div class="body" x-ref="body"&gt;&lt;/div&gt;'</span> <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">                <span class="cm-string">'&lt;/div&gt;'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  },</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  <span class="cm-property">ready</span>: <span class="cm-keyword">function</span>() {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">this</span>.<span class="cm-property">once</span>(<span class="cm-string">'changed.contents'</span>, (<span class="cm-keyword">function</span>() {</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-keyword">var</span> <span class="cm-def">children</span> <span class="cm-operator">=</span> <span class="cm-keyword">this</span>.<span class="cm-property">body</span>.<span class="cm-property">children</span>;</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-variable-2">children</span>.<span class="cm-property">push</span>.<span class="cm-property">apply</span>(<span class="cm-variable-2">children</span>, <span class="cm-keyword">this</span>.<span class="cm-property">contents</span>);</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    }).<span class="cm-property">bind</span>(<span class="cm-keyword">this</span>));</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">});</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">panel</span> <span class="cm-operator">=</span> <span class="cm-variable">Exact</span>.<span class="cm-property">Component</span>.<span class="cm-property">create</span>(<span class="cm-variable">Panel</span>, {<span class="cm-property">title</span>: <span class="cm-string">'SVG'</span>, <span class="cm-property">color</span>: <span class="cm-string">'#eee'</span>});</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">panel</span>.<span class="cm-property">set</span>(<span class="cm-string">'contents'</span>, [<span class="cm-variable">svg</span>, <span class="cm-variable">span</span>]);</span></pre></div>
      </div>
    </div>
    <h4>Lifecycle and Hooks</h4>
    <!--<h4>Form Inputs</h4>-->
  </article>
</div>

<!--<footer class="footer">
  <p>Released under the MIT license<br>
    © 2015 Chen Junyong. All rights reserved.</p>
</footer>-->

<!--<script src="../javascripts/codemirror.js"></script>-->
<!--<script src="../javascripts/javascript-mode.js"></script>-->
<!--<script src="../javascripts/code-format.js"></script>-->
<script src="../javascripts/site.js"></script>
</body>
</html>